% !TEX root = aws2014.tex

\section{Selmer group heuristics and sieves}
\thanksauthor{Bjorn Poonen}





\subsection{Sieves in arithmetic geometry}

Sieves form a very large topic, so we will only touch on a specific example, 
called the \emph{closed point sieve}. We'll start by counting square-free 
integers. For a subset $\cP\subset \dN$, the \emph{density} of $\cP$, written 
$\prob(\cP)$, is the limit 
\[
  \prob(\cP) = \lim_{B\to \infty} \frac{\# \cP\cap [1,B]}{B} .
\]

\begin{theorem}
$\prob(n\text{ is squarefree})=\prod_p (1-p^{-2}) = \zeta(2)^{-2} = \frac{6}{\pi}$. 
\end{theorem}

\begin{proof}
The basic idea is to ``sieve out the integers divisible by $p^2$,'' one prime 
a time. Choose cutoffs $r$ and $\sqrt B$. We consider primes $\leq p$ to be 
``small,'' primes between $r$ and $\sqrt B$ ``medium,'' and primes $>\sqrt B$ 
to be ``large.'' Fix $r$. Then 
\[
  \prob(p^2\nmid n\text{ for all $p\leq r$}) = \prod_{p\leq r} \left(1-\frac{1}{p^2}\right) .
\]
All that remains is to show that 
\[
  \lim_{r\to \infty} \bar\prob(n\text{ is divisible by $p^2$ for some $p>r$}) = 0 .
\]
Concretely, this is saying that 
\[
  \lim_{r\to\infty} \limsup_{B\to \infty} \frac{\#\{n\leq B:n\text{ is divisible by $p^2$ for some $p>r$}\}}{B} = 0 .
\]
Since all we need is an upper bound, we can use stupid upper bounds. We can 
start out with the medium primes. We have 
\begin{align*}
  \# \{n\leq B:n\text{ is divisible by $p^2$ for some $p\in (r,\sqrt B]$}\} 
    &\leq \sum_{p\in (r,\sqrt B]} \left\lfloor\frac{n}{p^2}\right\rfloor \\
    &\leq \sum_{p\in (r,\sqrt B)} \frac{B}{p^2} \\
    &\leq B\int_r^\infty \frac{dx}{x^2} \\
    &= \frac{B}{r} .
\end{align*}
All that remains is the large primes. But 
\[
  \#\{n\leq B:n\text{ is divisible b $p^2$ for some $p>\sqrt B$}\} = 0 ,
\]
so we are done. 
\end{proof}

Next we look at square-free values of a polynomial, e.g. 
$\prob(n^4+1\text{ is square-free})$. 

\begin{conjecture}
The probability is $\prod_p \left(1-\frac{c_p}{p^4}\right)$, where 
$c_p=\#\{n\in \dZ/p^2:n^4+1\equiv 0\}$. 
\end{conjecture}
\begin{proof}[Proof?]
We start with small primes as before. We get 
\[
  \prob(p\nmid n^4+1\text{ for all $p\leq r$}) = \prod_{p\leq r}\left(1-\frac{c_p}{p^2}\right) .
\]
Let's attack the large primes. Here \emph{large} means $p>B^2$. As before, 
\[
  \#\{n\leq B:p^2\nmid n^4+1\text{ for some $p>B^2$}\} =0 .
\]
All that remains are the medium primes, where \emph{medium} means 
$r<p\leq B^2$. If we try to repeat the na\"ive bound, we get, for each $p$ 
not dividing $\disc(x^4+1)$, 
\[
  \#\{n\leq B:p^2\mid n^4\} \leq 4\cdot \left\lceil\frac{B}{p^2}\right\rceil
\]
It follows that 
\begin{align*}
  \#\{n\leq B:p^2\mid n\text{ for some $p\in (r,B^2)$}\} 
    &\leq \sum_{p\in (r,B^2)} 4\left\lceil\frac{B}{p^2}\right\rceil \\
    &\leq \sum_{p\in (r,B^2)} \left(4\frac{B}{p^2} + 4\right) \\
    &\leq \frac 4 r B + 4\frac{B^2}{\log B^2} ,
\end{align*}
which is \emph{not} small enough relative to $B$ for the proof to work. 
\end{proof}

This conjecture follows from the ABC conjecture due to the work of many people 
(Browking, Filaseta, Greaves, Schinzel, Granville). They worked with arbitrary 
cyclotomic polynomials. 





\subsection{Closed points and zeta functions}

Let $k$ be a field, and $X$ a scheme of finite type over $k$. A \emph{closed 
point} of $X$ is exactly that -- a point in $X$ which is closed. In an affine 
chart $\spec(A)$, closed points $P$ correspond to maximal ideals 
$\fm\subset A$. Let $\kappa(P)$ be the \emph{residue field} of $P$, i.e. the 
field $A/\fm$. The weak nullstellensatz tells us that $\kappa(P)$ is a finite 
extension of $k$. These notions also make sense if $X$ is a scheme of finite 
type over $\spec(\dZ)$. In that case, the residue fields will be finite. 

If $X/k$ is of finite type and $P$ is a closed point in $X$, then we define the 
\emph{degree} of $P$, written $\deg P$, to be the integer $[\kappa(P):k]$. 
If $\kappa(P)=A/\fm$ for some affine chart $\spec(A)$, then 
$\deg P=[A/\fm:k]$. 

\begin{example}
A closed point on $\dA^1$ corresponds to a maximal ideal of $k[t]$. Such ideals 
are generated by unique monic irreducible polynomials in $k[t]$, which are 
in bijection with $\gal(\bar k/k)$-orbits in $\dA^1(\bar k)$. 
\end{example}

More generally, if $X$ is a $k$-scheme, a closed point of $X$ will correspond 
to a $\gal(\bar k/k)$-orbit in $X(\bar k)$. Write $|X|$ for the set of closed 
points in $X$. 

We can reinterpret the Riemann zeta function as 
\[
  \zeta_{\spec\dZ}(s) = \prod_{p\text{ prime}} (1-p^{-s})^{-1} = \prod_{P\in |\spec \dZ|} (1-\#\kappa(P)^{-s})^{-1} .
\]
In general, if $X$ is a scheme of finite type over $\dZ$, we define 
\[
  \zeta_X(s) = \prod_{P\in |X|} (1-\# \kappa(P)^{-s})^{-1} .
\]
This Euler product converges for $\Re(s)>\dim X$. As a special case, any scheme 
of finite type over $\dF_q$ has a zeta function. In that case, 
$\#\kappa(P)=q^{\deg P}$, so 
\[
  \zeta_X(s) = \prod_{P\in |X|} (1-q^{-s\deg P})^{-1} .
\]
As a power series in $T=q^{-s}$, this turns out to be 
\[
  Z_X(T) = \exp\left(\sum_{r\geq 1} \frac{\# X(\dF_{q^r})}{r} T^r \right) .
\]





\subsection{Bertini smoothness theorems}

Let $X\subset \dP^n$ be defined over a field $k$. Suppose $X$ is smooth of 
dimension $m$ over $k$. We only assume $X$ is quasi-projective. Then there 
exists a dense open $U\subset (\dP^n)^\vee$ such that for all $u\in U$, 
the corresponding hyperplane $H_u\subset \dP_{\kappa(u)}^n$ has $H_u\cap X$ 
smooth of dimension $n-1$ over $\kappa(u)$. 

\begin{corollary}
If $k$ is infinite, there exists $H/k$ such that $H\cap X$ is smooth. 
\end{corollary}

If $k$ is finite, this corollary is wrong! To fix this, we will change the 
problem. Let $S=\dF_q[x_0,\dots,x_n]$ and $\dP^n=\proj(S)$. Let 
\[
  S_d = \{\text{homogeneous polynomials of degree $d$ in $S$}\} ,
\]
and put $S_{\hom}=\bigcup_{d\geq 0} S_d$. For $f\in S_d$, let 
$H_f = \proj(S/f)$. For $\cP\subset S_{\hom}$, define the \emph{density} of 
$\cP$ to be 
\[
  \mu(\cP) = \lim_{d\to \infty} \frac{\#\cP\cap S_d}{\# S_d} .
\]

\begin{theorem}[Bertini smoothness over $\dF_q$]
Let $X$ be a smooth $m$-dimensional quasi-projective subscheme of 
$\dP^m$ over $\dF_q$. Then 
\[
  \cP=\{f\in S_{\hom}:H_f\cap X\text{ is smooth of dimension $m-1$}\} 
\]
has density $\mu(\cP) = \zeta_X(m+1)^{-1}\in \dQ\cap [0,1]$. 
\end{theorem}

For comparison, 
\[
  \prob(n\ne 0\text{ in }\spec\dZ\text{ is regular}) = \zeta(2)^{-1} 
\]
where $2=\dim(\spec\dZ)+1$. There is a conjectural joint generalization of 
these two facts. 

\begin{example}
Let $X+\dP^2$ over $\dF_2$. The question in this example is: what is the 
probability that a plane curve is smooth? It turns out that 
$\#\dP^2(\dF_{2^r}) = 4^r+2^r+1$, so 
$Z_X(T) = \left((1-T)(1-2 T)(1-4 T)\right)^{-1}$, so we get the following 
theorem. 
\end{example}

\begin{theorem}
$\mu(\text{smooth plane curves in $\dP^2$ over $\dF_2$}) = \frac{21}{64}$. 
\end{theorem}

\begin{proof}[Proof of Bertini theorem]
We'll do the case $X=\dA^2\subset \dP^2$. Identify $f\in S_{\hom}$ with its 
dehomogenization $f(1,x,y)\in \dF_q[x,y]$. Recall that $f\in \cP$ if and only 
if $H_f$ is smooth (of dimension $1$) at each closed point $P\in \dA^2$. For 
each $P$, $H_f$ is smooth at $P$ if and only if 
$f(P), \frac{\partial f}{\partial x}(P), \frac{\partial f}{\partial y}(P)$ are 
not all zero in $\kappa(P)=\dF_{q^{\deg P}}$. A fake proof is: 
\[
  \prob(H_f\text{ is smooth at }P) = 1-\frac{1}{q^{3\deg P}} \Rightarrow \prob(H_f\text{ smooth}) = \prod_{P\in \dA^2}\left(1-\frac{1}{q^{3\deg P}}\right) ,
\]
which is our zeta value $\zeta_{\dA^2}(3)^{-1}$. 

As with square-free integers, we'll choose a cutoff $r$, and call degree 
$\leq r$ \emph{low}, degree between $r$ and $d/3$ \emph{medium}, and degree 
$>d/3$ \emph{high}. We will treat these cases separately. Let 
\[
  \cP_r = \{f\in S_{\hom}:H_f\text{ is smooth at all $P$ with $\deg P\leq r$}\}
\]

\begin{lemma}
$\mu(\cP_r) = \prod_{\deg P\leq r} \left(1-\frac{1}{q^{3\deg P}}\right)$. 
\end{lemma}
\begin{proof}
Let $\fm_P\subset \dF_q[x,y]$ be the maximal ideal corresponding to $P$. Let 
$I=\prod_{\deg P\leq r} \fm_P^2$. Then $f\in S_d$ belongs to $\cP_r$ if and 
only if the image of $f$ under  
\[
  \dF_q[x,y]_{\leq d} / I \xrightarrow{\phi_d} \prod_{\deg P\leq r} \dF_q[x,y]/\fm_P^2
\]
is non-zero in each factor. For this to work, we need $\phi_d$ to be 
surjective when $d\gg 0$, but this is obvious. 
\end{proof}

How large must $d$ be? Let $V_d=\im(\phi_d)$. Then $V_{d+1}=V_d+x V_d+y V_d$. 
The sequence $V_0\subset V_1\subset \cdots \subset \cdots$ must terminate at 
some $D$. In fact, once $V_D=V_{D+1}$, we know that $\phi_D$ is surjective. In 
fact, $D\leq \dim_{\dF_q}(\dF_q[x,y]/I)$. Thus $\phi_d$ is surjective for 
$d\geq \dim_{\dF_q}(\dF_q[x,y]/I)$. 

Now we look at points of medium degree. Let 
\[
  Q_r = \bigcup_d \{f\in S_d : \text{there is $P$ with $r<\deg P\leq d/3$ at which $H_f$ not smooth}\} .
\]
\begin{lemma}
$\bar\mu(Q_r)\to 0$ as $r\to \infty$. 
\end{lemma}
\begin{proof}
The map $\dF_q[x,y]_{\leq d} \to \dF_p[x,y]/\fm_P^2$ is surjective for all 
$P$ with $d\geq 3\deg P$. Thus 
\[
  \bar\mu(Q_r) \leq \limsup_{d\to \infty} \sum_{r<\deg P\leq d/3} \frac{1}{q^{3\deg P}} \to 0 .
\]
\end{proof}

The tricky part is handling large degree points. 
\begin{lemma}
Fix a curve $Z\subset \dA^2$, i.e. $\dim Z=1$. Then 
\[
  \frac{\#\{f\in \dF_q[x,y]_{\leq d}:f|_Z=0\}}{\#\dF_q[x,y]_{\leq d}} \leq q^{-d} .
\]
\end{lemma}
\begin{proof}
Choose a coordinate, say $x$, such that $x$ is non-constant on $Z$. We would 
like to bound the size of the kernel in 
\[
  0 \to \ker \to \dF_q[x,y]_{\leq d} \to \h^0(\sO_Z) .
\]
Note that the image has dimension at least $d+1$, because it contains 
$1,x,\ldots,x^d$. 
\end{proof}

We are trying to bound the size of the set 
\[
  \cR = \bigcup_d \{f\in S_d:H_f\text{ is not smooth at some $\deg P>d/3$}\} .
\]
\begin{lemma}
$\mu(\cR)=0$. 
\end{lemma}
\begin{proof}
Write $f=f_0+g_1^p x + g_2^p y + h^p$, for random $f_0,g_1,g_2, h$ of degrees 
$\leq d$, $\leq \frac{d-1}{p}$, $\leq \frac{d-1}{p}$, $\leq \frac d p$. This is 
a random element of $\dF_q[x,y]_{\leq d}$. We have 
\begin{align*}
  \frac{\partial f}{\partial x} &= \frac{\partial f_0}{\partial x} + g_1^p \\
  \frac{\partial f}{\partial y} &= \frac{\partial f_0}{\partial y} + g_2^p .
\end{align*}
Given $f_0$, there is at most one $g_1$ with $\partial_x f =0$. So 
\begin{align*}
  \prob(g_1\text{ is s.t.} \dim\{\partial_x f=0\}\leq 1 | \text{choice of $f_0$}) 
    &\approx 1 \\
   \prob(g_g\text{ is s.t.} \dim\{\partial_x f=\partial_y f=0\}\leq 0 | \text{choice of $f_0,g_1$})
    &\approx 1 .
\end{align*}
The condition $\dim\{\partial_x f = \partial_y f = 0\}\leq 0$ fails if and only 
if $\partial_y f_0 + g_2^q$ vanishes on some component of $\{\partial_x f=0\}$. 
\end{proof}

We know that $\cP=\cP_r\minus Q_r\minus \cR$. As $r\to \infty$, 
$\mu(\cP_r \to \zeta_{\dA^2}(3)^{-1}$, 
$\bar\mu(Q-r) \to 0$, and $\mu(\cR)=0$. Thus we have proved that 
$\mu(\cP)=\zeta_{\dA^2}(3)^{-1}$. 
\end{proof}

There are variants of the Bertini theorem. For example, we could prescribe the 
Taylor coefficients at finitely many points. This lets us answer a question of 
Nick Katz (the question was also resolved by Ofer Gabber). Given a nice variety 
$X$ over $\dF_q$ of dimension $\geq 1$ (Here, ``nice'' means ``smooth, 
projective and geometrically integral.), there is a nice curve 
$Y\subset X$ such that $Y(\dF_q)=X(\dF_q)$.  

Also, you can use the Bertini theorem to obtain abelian varieties as quotients 
of Jacobians of curves (which are themselves contained in the abelian variety). 
Let $A$ be of dimension $\geq 1$ over $\dF_q$. Then there is a nice curve 
$X\subset A$ such that $\operatorname{Jac} X\to A$ is surjective. The trick 
is to find $X$ passing through all $\ell$-torsion points of $A$. This forces 
$\operatorname{Jac} X$ to have $\ell^{2\dim A}$ torsion points, i.e. it has 
the same dimension as $A$. 

In Nguyen's thesis, we have a Whitney embedding theorem for finite fields. 
Let $X$ be a nice curve over $\dF_q$. Then there is a closed immersion 
$X\hookrightarrow \dP_{\dF_{q^3}}$ if and only if for each $e\geq 1$, 
$\# X(\dF_{q^e}) \leq \dP^3(\dF_{q^e})$. 





\subsection{Selmer group heuristics}

Let $G=\gal(\bar\dQ/\dQ)$ be the absolute Galois group of $\dQ$. Let 
\[
  \dQ_v = \begin{cases} \dR & v=\infty \\ \dQ_p & v=p \end{cases}
\]
Let $\dA$ be the ring of adeles of $\dA$, i.e. 
\[
  \dA = \prod_v' (\dQ_v,\dZ_v) = \{(a_v)\in \prod \dQ_v:a_v\in \dZ_v\text{ almost all }v\} .
\]


\begin{theorem}
Let $E$ be an elliptic curve over $\dQ$. Then $E(\dQ)$ is finitely generated. 
\end{theorem}

There is basically only one proof of this. First, one shows ``weak 
Mordell-Weil.'' i.e. that $E(\dQ)/n$ is finite for some $n\geq 2$. Then one 
uses height functions to get the general case. Consider the exact sequence 
\[
  0 \to E[n] \to E\xrightarrow n E \to 0
\]
of sheaves on the \'etale site of $\dQ$. We can take $G$-invariants (i.e. 
$\h_\et^0$) we get a sequence 
\[
  0 \to E[n](\dQ) \to E(\dQ) \xrightarrow n E(\dQ) \to \h^1(\dQ, E[n]) \to \h^1(\dQ,E) \xrightarrow n \h^1(\dQ,E) \to \cdots
\]
We use $\h^1(\dQ,E)$ as an abbreviation for 
$\h_\et^1(\dQ,E) = \h^1(G_\dQ,E(\bar\dQ))$. So we have a sequence 
\[
  0 \to E(\dQ)/n \to \h^1(\dQ,E[n]) \to \h^1(\dQ,E) .
\]
Unfortunately, $\h^1(\dQ,E[n])$ is infinite. We have the same sequence at all 
places of $\dQ$:
\[
  E(\dQ_v)/n \to \h^1(\dQ_v,E[n]) \to \h^1(\dQ_v,E) .
\]
Combine all these to get a commutative diagram 
\[\xymatrix{
  0 \ar[r] 
    & E(\dQ)/n \ar[r] \ar[d] 
    & \h^1(\dQ,E[n]) \ar[r] \ar[d] 
    & \h^1(\dQ,E) \ar[d] \\
  0 \ar[r] 
    & \prod_v E(\dQ_v)/n \ar[r] 
    & \prod_v\h^1(\dQ_v,E[n]) \ar[r] 
    & \prod_v \h^1(\dQ_v,E)
}\]
We can actually use restricted direct products on the bottom, so we put 
\begin{align*}
  E(\dA)/n &= \prod_v' E(\dQ_v)/n \\
  \h^1(\dA,E[n]) &= \prod_v' \h^1(\dQ_v,E[n]) \\
  \h^1(\dA,E) &= \prod_v' \h^1(\dQ_v,E)
\end{align*}
To sum up, we have a commutative diagram with exact rows:
\[\xymatrix{
  0 \ar[r] 
    & E(\dQ)/n \ar[r] \ar[d] 
    & \h^1(\dQ,E[n]) \ar[r] \ar[d]^-\beta  
    & \h^1(\dQ,E) \ar[d]^-\gamma  \\
  0 \ar[r] 
    & E(\dA)/n \ar[r]^-\alpha 
    & \h^1(\dA,E[n]) \ar[r] 
    & \h^1(\dA,E) 
}\]
Define the \emph{$n$-Selmer group} and \emph{Tate-Shafarevich group} of $E$ by 
\begin{align*}
  \selmer_n(E) &= \beta^{-1}(\im\alpha) \\
  \sha(E) &= \ker\gamma .
\end{align*}
Standard theorems of algebraic number theory yield the finiteness (and 
computability) of $\selmer_n E$. 

For an elliptic curve $E$ over $\dQ$, find a model $E:y^2=x^3+A x+B$ with 
$A,B\in \dZ$ minial, and put $h(E)=\max(|A|^3,|B|^2)$. Let $\cE$ be the set of 
isomorphism classes of elliptic curves over $\dQ$. For any $x$, put 
$\cE_{<x} = \{E\in \cE:h(E)<x\}$. 

\begin{definition}
If $S\subset \cE$, put 
\[
  \prob(S)= \lim_{X\to \infty} \frac{\#(S\cap \cE_{<X})}{\# \cE_{<X}} .
\]
\end{definition}

Given $p$ and $s$, we are interested in computing 
\[
  \prob(\dim_{\dF_p} \selmer_p E = s) .
\]





\subsection{Maximal isotropic subspaces}

Let $V=\dF_p^{\oplus 2 n}$, and let 
\[
  Q(x_1,\dots,x_n,y_1,\dots,y_n) .
\]
We call $V$ a \emph{hyperbolic quadratic space} over $\dF_p$. The function $Q$ 
induces a pairing $\langle-,-\rangle$ on $V$ by 
\[
  \langle v,w\rangle = Q(v+w)-Q(v)-Q(w) .
\]
For $Z\subset V$ an $\dF_p$-subspace, put 
\[
  Z^\bot = \{v\in V:\langle v,z\rangle = 0\text{ for all }z\in Z\} .
\]
We call $Z$ \emph{isotropic} if $Q|_Z=0$. The space $Z$ is \emph{maximal 
isotropic} if $Q|_Z=0$ and $Z=Z^\bot$. All maximal isotropic subspaces of $V$ 
have dimension $n$. 

\begin{example}
The space $\{(x_1,\dots,x_n,0,\dots,0):x_i\in \dF_p\}$ is maximal isotropic. 
\end{example}

Put 
\[
  \orthogonalgrassmannian_n(\dF_p) = \{\text{maximal isotropic subspaces of $V$}\} .
\]
Choose $Z,W\in \orthogonalgrassmannian_n(\dF_p)$ at random. This gives us a random 
variable $\dim_{\dF_p}(Z\cap W)$. 

\begin{conjecture}[Poonen, Rains]
For each $s\in \dZ_{\geq 0}$, 
\[
  \prob_{E\in \cE} (\dim \selmer_p E=s) = \lim_{n\to \infty} \prob_{Z,W\in \orthogonalgrassmannian_n(\dF_p)}(\dim(Z\cap W)=s) .
\]
\end{conjecture}

Our goal is to show that $\selmer_p E$ actually is an intersection of maximal 
isotropic subspaces in an infinite-dimensional quadratic space. For simplicity, 
we assume $p$ is odd. 

We'll start with a construction for local fields. Let $E$ be an elliptic curve 
over some $\dQ_v$. Put $V_v=\h^1(\dQ_v,E[p])$; this is a finite-dimensional 
$\dF_p$-vector space. Recall the \emph{Weil pairing} is a bilinear pairing  
\[
  e:E[p]\times E[p] \to \dG_m
\]
This induces a pairing 
\[
  \langle\cdot,\cdot\rangle_v:V_v\times V_v\xrightarrow\smallsmile \h^2(\dQ_v,E[p]^{\otimes 2}) \xrightarrow e \h^2(\dQ_v,\dG/m) = \operatorname{Br}\dQ_v\hookrightarrow\dQ/\dZ .
\]
So we have $Q_v:V_v\to \dR/\dZ$. Define $W_v=\im(E(\dQ_v)/p\subset V_v)$. It is 
a theorem of O'Neil (using Tate local duality) that $W_v$ is a maximal isotropic 
subspace of $V_v$. 

Over global fields, let $V_v=\h^1(\dQ_v,E[p])$ for each $v$. Let 
\[
  V = \prod_v' (V_v,W_v) \simeq \h^1(\dA,E[p]) .
\]
As before, we have a commutative diagram 
\[\xymatrix{
  & \h^1(\dQ,E[p]) \ar[d]^-\beta \\
  E(\dA)/p \ar[r]^-\alpha 
    & \h^1(\dA,E[p])
}\]
Let $Q=\sum Q_v:V\to \dR/\dZ$. 

\begin{theorem}
The images of $\alpha$ and $\beta$ are maximal isotropic. Moreover, $\beta$ is 
injective, and $\im(\alpha)\cap \im(\beta) = \beta(\selmer_p E)\simeq \selmer_p E$. 
\end{theorem}

So in some sense, $\selmer_p E$ ``is'' the intersection of two maximal isotropic 
subspaces of $\h^1(\dA,E[p])$. 

To show that $\alpha$ has maximal isotropic image, simply note that 
$\im(\alpha)=\prod_v W_v$. To show the same about $\im(\beta)$, use some global 
duality theorems (9-term Poitu-Tate exact sequence). To show that $\beta$ is 
injective, use \v Cebotarev, plus the fact that the Sylow $p$-subgroup of 
$\operatorname{GL}_2(\dF_p)$ is cyclic. The third part follows from the first 
two and the definition of $\selmer_p(E)$. 




