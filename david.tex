% !TEX root = aws2014.tex

\section{Curves and zeta functions over finite fields}
\thanksauthor{Chantal David}





\subsection{Motivating results}

The biggest influence here is philosophy of Katz and Sarnak that statistics 
for zeros of $L$-functions should match the corresponding statistics for 
eigenvaluges of large random matrices. The main work of Katz and Sarnak here 
is \cite{ks99}. 

Let's start with work of Montgomery from 1974. We assume the Riemann hypothesis, 
so that we can look at the set of $t\in \dR$ such that 
$\zeta(\frac 1 2+i t)=0$. Let 
\[
  N(T) = \#\{0<t<T:\zeta(\frac 1 2+i t) 0\}  \sim \frac{T\log T}{2\pi} .
\]
For $\zeta(\frac 1 2+i\gamma)=0$, put $\tilde\gamma=\frac{\gamma\log\gamma}{2\pi}$. 
The \emph{pair correlation} is 
\[
  \frac{1}{N(T)} \sum_{0<\gamma,\gamma'<T} f(\tilde\gamma'-\tilde\gamma) .
\]

\begin{theorem}
\[
  \frac{1}{N(T)} \sum_{0<\gamma,\gamma'<t} f(\tilde\gamma-\tilde\gamma') \to \int_\dR f(x)\left(1=\frac{\sin^2(\pi x)}{(\pi x)^2}\right)\, dx 
\]
for some test function $f$ such that 
$\supp(\hat f) \subset (-\delta,\delta)$. 
\end{theorem}

Let $\unitary(N)$ be the group of $N\times N$ unitary matrices, i.e. 
$U$ with $U^\ast U = U U^\ast = 1_N$. Any such matrix has eigenvalues 
$\lambda_j(U)=e^{i \theta_j(U)}$ for $i=1,\dots,N$. Put 
\[
  C_f(U) = \sum_{1\leq k < j \leq N}f\left(\frac{N}{2\pi} \theta_j - \frac{N}{2\pi} \theta_k\right) .
\]

\begin{theorem}
\[
  \int_{\unitary(N)} C_f(U)\, dU \to \int_{-\infty}^\infty f(x)\left(1-\frac{\sin^2(\pi x)}{(\pi x)^2} \right)\, dx .
\]
\end{theorem}
The function $1-\frac{\sin^2(\pi x)}{(\pi x)^2}$ appearing in this theorem is 
called the \emph{scaling limit}. 

There is numerical evidence -- it has been checked up to $10^{20}$. There are 
generalizations to zeros of automorphic representations of $GL(n)$ due to 
Rudrick and Sarnak. Finally, this was proven over function fields 
when $q\to \infty$.





\subsection{One-level densities}

Another statistic is the \emph{one-level density}, which is the study of the 
``low lying zeros.'' Here you study these zeros for a family of $L$-functions. 
Our main examples come from families of elliptic curves over $\dQ$, or 
families of $L$-functions attached to quadratic Dirichlet characters. 

Define 
\[
  W_f(E) = \sum_{L(1+i\gamma_E,E) = 0} f\left(\frac{\gamma_E\log N_E}{2\pi}{2\pi}\right) .
\]
for $f$ a function in the Schwarz space. Let the 
\emph{completed $L$-function of $E$} to be 
\[
  \Lambda(s,E) = \left(\frac{\sqrt{N_E}}{2\pi}\right)^2 \Gamma(s) L(s,E) = \Lambda(2-s,E) .
\]
The \emph{one-level density} is 
\[
  \langle W_f(E)\rangle_{\sF(X)} = \frac{1}{\# \sF(X)} \sum_{E\in \sF(X)}W_f(E) 
\]
where $\sF(X)$ is a family of elliptic curves with conductor $\sim X$. 

\begin{conjecture}[Katz-Sarnak]
\[
  \langle W_f(E)\rangle_{\sF(X)}  \to \int_\dR f(x) W_G(x)\, dx ,
\]
where $W_G(x)$ depends on the ``symmetry type'' of the family. 
\end{conjecture}

Consider the following table for $W_g(x)$:
\begin{center}
\begin{tabular}{c|c}
  1 & $\unitary$ unitary \\
  $1-\frac{\sin(\pi x)}{2\pi x}$ & $\unitarysymplectic$ symplectic \\
  $1+\frac 1 2 \delta_0(x)$ & $\orthogonal$ orthogonal \\
  $1+delta_0(x)-\frac{\sin(\pi x)}{2\pi x}$ & $\specialorthogonal$ odd-dimensional \\
  $1+\frac{\sin(2\pi x)}{2\pi x}$ & $\specialorthogonal$ even-dimensional
\end{tabular}
\end{center}

These are the scaling densities for the one level density on the matrix groups. 

\begin{theorem}
\[
  \int_{\orthogonal(N)} W_f(U)\, dU \to \int_\dR f(x) \left(1+\frac 1 2 \delta_0(x)\right)\, dx = \hat f(0) + \frac 1 2 f(0) .
\]
\end{theorem}

The Fourier transforms of $\orthogonal$ and $\specialorthogonal$ agree for 
$|U|<1$. 

Try the family $y^2=x^3+a x+b$ of elliptic curves, where 
$|a|\leq X^{1/3}$ and $b\leq X^{1/2}$, i.e. such that 
$\Delta_E\asymp X$. There is an explicit formula due to Weil. 
\[
  \sum_{\gamma_E} f\left(\frac{\gamma_E\log N_E}{2\pi}\right) = \hat f(0)+\frac 1 2 f(0) - \sum_p \frac{2\log p}{p\log N_E} \hat f\left(\frac{\log p}{\log N_E}\right) a_p(E) + O\left(\frac{\log\log N_E}{\log N_E}\right)
\]
This comes from the integral 
\[
  \int_{(2+\varepsilon)} \frac{\Lambda'}{\Lambda}(s)  h(s)\, ds .
\]

Recall that we have 
$\Lambda(s,E) = \left(\frac{\sqrt{N_E}}{2\pi}\right)^s \Gamma(s) L(s,E)$. 
There is a sum 
\[
  \frac{L'}{L}(s) = \sum_{p,k} \frac{\alpha_p^k + \bar\alpha_p^k}{k p^{k s}} p^s ,
\]
where $\alpha_p^2 + \bar\alpha_p^2 = \alpha_p^2 - 2 p$. Then 
\[
  \langle W_f(E)\rangle_{\sF(X)} = \hat f(0) + \frac 1 2 f(0) + \frac{2}{\log X}\sum_{p\leq X^\delta} \frac{\log p}{p} \sum_{E\in \sF(X)} \alpha_p 
\]
provided $\hat f$ has support in $(-\delta,\delta)$. 

\begin{theorem}[Young]
$\langle W_f(E)\rangle_{\sF(X)} = \hat f(0)+\frac 1 2 f(0)$, for 
$\supp(\hat f)\subset (-\frac 7 9, \frac 7 9)$. 
\end{theorem}

This confirms ``$\orthogonal$ symmetries'' (well also, 
$\specialorthogonal$ would also work). 

\begin{corollary}
The average analytic rank is at most $\frac 1 2+\frac 9 7=\frac{25}{14}<2$. 
\end{corollary}

\begin{example}
In this example, the symmetry type is not clear a priori. Let 
\[
  E_t:y^2=x^3+t x^2-(t+3) x+ 1 \qquad t\in \dZ .
\]
This is due to Washington-Rizzo. This family has rank one over $\dQ(t)$. 
Also, $W(E_t) = -1$ for all $t\in \dZ$. 
\end{example}

\begin{theorem}[Miller]
Let $\sF(X)=\{E_t:t\sim X^{1/4}\}$. Then 
\[
  \langle W_f(E_t)\rangle_{\sF(X)} \sim \hat f(0) + \frac 3 2 f(0) 
\]
for $\supp(\hat f)\subset (-\frac 1 3,\frac 1 3)$. 
\end{theorem}
This agrees with $W(x) = \delta_0(X)+\specialorthogonal(\text{odd})$. 

\begin{theorem}[Huyhn-Parks-David]
Assume the ratio conjectures. Then 
\[
  \langle W_f(E_t)\rangle_{\sF(X)} \sim \int_{-\infty}^\infty f(x) \left(\delta_0(x)+1+\frac{\sin(2\pi x)}{2\pi x}\right)\, dx 
\]
i.e. $W(x)=\delta_0(x)+\specialorthogonal(\text{even})(x)$. 
\end{theorem}

\begin{example}
Consider $L(s,\chi_d)$, where $\chi_d=\left(\frac d n\right)$, where 
$d\sim X$ is a fundamental discriminant. 
\end{example}

\begin{theorem}[Sarnak, Ozlek Snyder]
\[
  \langle W_f(d)\rangle_{D(X)} = \int_\dR f(x)\left(1-\frac{\sin(2\pi x)}{2\pi x}\right)\, dx 
\]
when $\supp(f)\subset (-2,2)$. 
\end{theorem}

These are symplectic symmetries. We would like to compute the $n$-level 
densities for this same family. 

\begin{theorem}[Rubenstein]
\[
  \langle W_f^{(n)}(d)\rangle_{D(X)} \to \int_{\dR^n} f(x_1,\dots,x_n)  W^{(n)}(x_1,\dots,x_n) dx_1,\dots,x_n .
\]
when $\hat f(u_1,\dots,u_n)$ has support contained in 
$\{\sum |u_i|<1\}$. 
\end{theorem}

Try to extend this to $\sum |u_i|<2$. There is a theorem of Gao (for $n=3,4$) 
and Miller (for $n=5,6$) that 
\[
  \langle W_f^{(n)}(d)\rangle_{D(X)} = A(f) + o(1) .
\]

\begin{theorem}
This was proven for all $n$ by Entin-Roddity-Gershon-Rudnick, using 
hyperelliptic curves (i.e. the Katz-Sarnak equidistribution theorem). 
\end{theorem}





\subsection{\texorpdfstring{$L$}{L}-functions over function fields}

Consider the following list of analogies between number fields and 
function fields. 
\begin{center}
\begin{tabular}{c|c}
  number fields & function fields \\ \hline
  $\dQ$ & $k=\dF_q(T)$ \\
  $\dZ$ & $A=\dF_q[T]$ \\
  $p$ prime & $P(T)$ irreducible monic \\
  $|n|$ & $q^{\deg F}$
\end{tabular}
\end{center}
The ``Riemann zeta function'' over $\dF_q(T)$ is 
\begin{align*}
  \sum_F \frac{1}{|F|^s} 
    &= \prod_P \left(1-\frac{1}{|P|^s}\right)^{-1} \\
    &= \sum_{d=0}^\infty \frac{q^d}{q^{d s}} \\
    &= \sum_{d=0}^\infty (q^{1-s})^d \\
    &= \frac{1}{1-q^{1-s}}
\end{align*}
So the ``Riemann hypothesis'' holds for $\dF_q(T)$. We would like to use this 
to prove the ``Prime Number Theorem'' for $\dF_q[T]$. Let $a_d$ be the number 
of prime polynomials $P$ of degree $d$. Put 
\[
  \zeta_q(s) = \prod_{d=1}^\infty \left(1-\frac{1}{q^{d s}}\right)^{-a_d} = \frac{1}{1-q^{1-s}} .
\]
Make the substitution $u=q^{-s}$, and we get 
\[
  \prod_{d=1}^\infty \left(1-\frac{1}{u^d}\right)^{-a_d} = \frac{1}{1-q u} .
\]
We can take the logarithmic derivative, and get
\[
  u\sum_{d=1}^\infty a_d \frac{d}{du} \log(1-u^d) = u\frac{d}{du}\log(1-q u). 
\]
This tells us that 
\[
  \sum_{d=1}^\infty \frac{a_d d u^d}{1-u^d} = \frac{q u}{1-q u} .
\]
Writing the geometric series, 
\[
  \sum_{d=1}^\infty d a_d \sum_{n=1}^\infty u^{d n} = \sum_{d=1}^\infty (q u)^d .
\]
We can equate the coefficients of powers of $u$, to obtain 
\[
  q^d = \sum_{n\mid d} n a_n 
\]
Using M\"obius inversion, we get 
\[
  a_n = \frac 1 n \sum_{d\mid n} \mu(d) u^{n/d} .
\]
This yields the Prime Number Theorem for function fields:

\begin{theorem}
$a_n = \frac{q^n}{n} + o(\frac{q^{n/2}}{n}+\frac{q^{n/3}}{n}\sum_{d\mid n}\ldots)$. 
\end{theorem}

Let $\#\sF_d$ be the number of square-free polynomials of degree $d$. 

\begin{lemma}
We have 
\[
  \#\sF_d = \begin{cases} 
              q^d - q^{d-1} = \frac{q^d}{\zeta_q(2)} & d\geq 2 \\
               q^d & d=0,1 
            \end{cases}
\]
\end{lemma}
\begin{proof}
Note that $\zeta_q(s) = \zeta_q(2 s) \sum_{n=1}^\infty (\# \sF_d) q^{-d s}$. 
\end{proof}

Let $K$ be a general function field, i.e. a finite extension of 
$k=\dF_q(T)$. For example, we could have 
$K=k(\sqrt[\ell]{D(T)})$ for some irreducible $D\in \dF_q[T]$. Let 
$\cP_K$ be the set of primes of $K$. If $P\in \cP_K$ has valuation ring 
$R$, we put $|P| = \#(R/P)$. 

If $k=\dF_q(T)$, then $\cP_k$ is the set of irreducible polynomials in 
$\dF_q[T]$, together with $\infty$ coming from the valuation ring 
$\dF_q[\frac 1 T]$. Let $\cD_k$ be the free abelian group on $\cP_k$; we 
call $\cD_k$ the \emph{divisor group} of $k$. If 
$D=\sum a_P(P)$ is a divisor over $k$, define $\deg D=\sum a_P \deg P$, 
$|D|=q^{\deg D}$. We have $|D_1+D_2|=|D_1|\cdot |D_2|$. Let 
$\cD_k^+$ be the set of effective divisors ($D=\sum a_p(P)$ with 
$a_P\geq 0$ for all $P$). We define 
\[
  \zeta_k(s) = \sum_{D\in \cD_k^+} |D|^{-s} = \prod_{P\in \cP_k} \left(1-\frac{1}{|P|^s}\right)^{-1} .
\]

\begin{example}
We have 
\[
  \zeta_{\dF_q(x)}(s) = \prod_{P\subset \dF_q[x]}\left(1-\frac{1}{|P|^s}\right)^{-1} \prod_{P=\infty} \left(1-\frac{1}{q^s}\right)^{-1} = \frac{1}{(1-q^{1-s})(1-q^{-s})} .
\]
\end{example}

\begin{example}
Let $K=\dF_q(x)(\sqrt{D})$, where $D$ is irreducible. Then 
\begin{align*}
  \frac{\zeta_K(s)}{\zeta_k(s)} 
    &= \prod_{\substack{P\in S_k \\P\text{ inert in $k$}}} \frac{(1-|P|^{-2 s})^{-1}}{(1-|P|^{-s})^{-1}}\prod_{\substack{P\in S_K \\ P\text{ splits in $K$}}} \frac{(1-|P|^{-s})^{-2}}{(1-|P|^{-s})^{-1}}
\end{align*}
Write 
\[
  \frac{\zeta_K(s)}{\zeta_k(s)} = \prod_{P\in S_k}(1-\chi_K(P)|P|^{-s})^{-1} ,
\]
where 
\[
  \chi_K(P) = \begin{cases} 1 & P\text{ splits} \\ -1 & P\text{ inert} \\ 0 & P\text{ ramifies} \end{cases}
\]
We are looking at $y^2-D(x)\mod P$, and putting $\chi_K(P)=\left(\frac{D}{P}\right)$, 
the Dirichet character modulo $D$. Thus 
\[
  \frac{\zeta_K(s)}{\zeta_k(s)} = L(s,\chi_D) (1-q^{-s})^{-\lambda_D} 
\]
where $\lambda_D=1$ if $\deg D$ is even, and $0$ if $\deg D$ is odd. 
\end{example}

\begin{theorem}
Let $\chi$ be a non-trivial Dirichlet character to the modulos $\fm$. Then 
$L(s,\chi) = \sum_F \frac{\chi(F)}{|F|^s}$ is a polynomial in $q^{-s}$ of degree 
at most $\deg\fm-1$. 
\end{theorem}
\begin{proof}
Write $L(s,\chi) = \sum_{n=0}^\infty A(n,\chi) q^{-n s}$, where 
$A(n,\chi) = \sum_{\deg F=n} \chi(n)$. If $n\geq \deg \fm$, then each residue 
class modulo $\fm$ is represented exactly $q^{n-\deg\fm}$ times. So 
\[
  A(n,\chi) = q^{n-\deg\fm} \sum_{r\mod \fm} \chi(r) = 0 .
\]
\end{proof}

This works in general. 

\begin{theorem}
Let $\zeta_k(s) = \frac{P_k(q s)}{(1-q^{-s})(1-q^{1-s})}$. Then $P_k$ is a 
polynomial of degree at most $2 g$ in $q^{-s}$. 
\end{theorem}
\begin{proof}
Use the Riemann-Roch theorem. Let $b_n(k)$ be the number of effective divisors 
of degree $n$. By the Riemann-Roch theorem, for $n>2 g-2$, we have 
\[
  b_n(k) = h_k \frac{q^{n-g+1}-1}{q-1} 
\]
so consider 
\[
  Z_k(u) = \sum_{n=1}^\infty b_n u^n 
\]
and use the previous formula. We have $Z_k(u)=\frac{P_k(u)}{(1-u)(1-q u)}$. Let's 
look at the zeros of $P_k(u)$, so write 
$P_k(u) = \prod_{i=1}^{2 g} (1-u \alpha_j(k))$. If $\zeta_k(s)=0$, then 
$q^{-s} = \alpha_j(k)^{-1}$ for some $j$. So the Riemann Hypothesis tells us that 
$\zeta_k(s)=0$ iff $s=1/2$< i.e. iff $|\alpha_j(k)|=\sqrt q$. 
\end{proof}

\begin{theorem}[Weil, Stephanov-Bombieri]
The zetos of $\zeta_k(s)$ have $\Re(s)=\frac 1 2$, i.e. 
$|\alpha_j(k)| = \sqrt q$. 
\end{theorem}

\begin{corollary}
If we let $a_n(k) = \#\{P\in S_k\text{ of degree $N$}\} = \frac{q^N}{N}+O(q^{N/2})$. 
\end{corollary}

There is another formulation for $Z_k(u)$. Recall that 
$-\log(1-u) = \sum_{n=1}^\infty \frac{u^n}{n}$. We compute 
\begin{align*}
  \log Z_k(u) 
    &= \log \prod_{d=1}^\infty (1-u^d)^{-a_d(k)} \\
    &= \sum_{d,m} a_d(k) \frac{u^{d_m}}{m} \\
    &= \sum_{n=1}^\infty N_n(k) \frac{u^n}{n}
\end{align*}
where $N_n(k) = \sum_{d\mid n} d a_d(k)$. Moreover, 
\[
  \log Z_k(u) = \log\left(\frac{P_k(u)}{(1-u)(1-q u)}\right) = \sum \frac{u^n}{n} + \sum \frac{(q u)^n}{n} - \sum_{j=1}^{2 g} \sum_n \frac{\alpha_j(C)^n}{n} u^n .
\]
We can equate coefficients to get that $N_n(k)$ is the number of primes of 
degree $1$ in $\dF_{q^n} k$. Even better, 
$N_n(k) = q^n+1 - \sum_{j=1}^{2 g} \alpha_j(C)^n$. To relate this to Jordan's 
talks, we need to relate function fields with curves. 
\begin{center}
\begin{tabular}{c|c}
function fields $\dF_q(C)=dF_q[x,y]/(F)$ & curves over $\dF_q$, given by $F(x,y) = 0$ \\ \hline
$\dF_q(\sqrt D)$ & $y^2 = D(x)$ \\
primes in $\dF_q(C)$ & Galois orbits of points on $C(\bar\dF_q)$ \\
primes of degree one & points in $C(\dF_q)$ \\
primes of degree one in $\dF_{q^n} k$ & points in $C(\dF_{q^n})$
\end{tabular}
\end{center}

So 
\[
  Z_k(u) = \exp\left(\sum_{n=1}^\infty \# C(\dF_{q^n}) \frac{u^n}{n}\right) = Z_C(u) .
\]
So instead of talking about zeta functions of function fields, we will talk about 
zeta functions of curves. 

Recall the following theorem of Weil. 

\begin{theorem}[Weil]
Let $C$ be a smooth projective curve of genus $g$ over $\dF_q$, and let 
$Z_C(u) = \exp\left(\sum_n \# C(\dF_{q^n}) \frac{u^n}{n}\right)$. Then 
\[
  Z_C(u) = \frac{P_C(u)}{(1-u)(1-q u)} ,
\]
where $P_C(u)\in \dZ[u]$ has degree $2 g$. Moreover, if we write 
$P_C(u) = \prod_j (1-u \alpha_j(C))$, then$|\alpha_j(C)| = \sqrt q$. 
\end{theorem}

So taking logarithmic derivatives, we get 
\[
  \# C(\dF_{q^n}) - (q^n+1) = -\sum_{j=1}^{2 g} \alpha_j(C) ,
\]
so statistics of the zeros give statistics on the number of points. Of course, 
we get the famous Weil bound: 
\[
  |\# C(\dF_{q^n}) - (q^n+1)| \leq 2 g\sqrt q^n .
\]
Let's introduce some notation. Let $\theta_C$ be the $2 g\times 2 g$ matrix 
with diagonal entries $e^{i\theta_j(C)}$, where 
$\alpha_j(C) = \sqrt q e^{i\theta_j(C)}$. We want to study the distribution of 
the zeros when $C$ varies over a family of curves of genus $g$ over 
$\dF_q$. Let $\sF(g,q)$ be such a family. 

\begin{theorem}[Deligne]
Let $\cM_g(\dF_q)$ be the moduli space of curves of genus $g$ over $\dF_q$. Let 
$f$ be any class function on $\unitarysymplectic(2 g)$ (which is the monodromy 
group of the family). Then 
\[
  \lim_{q\to \infty}\frac{1}{\# \cM_g(\dF_q)} \sum_{C\in \cM_g(\dF_q)} f(\theta_C) = \int_{\unitarysymplectic(2 g)} f(U)\, d U .
\]
\end{theorem}

This is one of the key ingredients of Katz-Sarnak's proof of Montgomery's 
pair-correlation conjecture over function fields. 

What if we fix $q$ and let $g\to \infty$. What statistics do we get? The 
first work in this direction was due to Kurlberg-Rudnick on hyperelliptic 
curves. Let $\cH_g(\dF_q)$ be the moduli space of hyperelliptic curves over 
$\dF_q$. Such a curve is $y^2=F(x)$, where $F(x)$ is square-free. The genus 
is $g=\left\lfloor\frac{d-1}{2}\right\rfloor$, where $d=\deg F$. We ware 
interested in 
\[
  \lim_{g\to \infty} \frac{\#\{C\in \cH_g(\dF_q):\# C(\dF_q)=m\}}{\#\{C\in \cH_g(\dF_q)\}} \sim \prob\left(\sum_{i=1}^{q+1} X_i = m\right) ,
\]
where the $X_i$ are independent and identically distributed random variables 
such that 
\[
  X_i = \begin{cases} 0 & \text{probability }\frac{q}{2(q+1)} \\ 1 & \text{probability } \frac{1}{q+1} \\ 2 & \text{probability }\frac{q}{2(q+1)} \end{cases}
\]
At the end, this depends on $\prob(F(a)=0)$ for $a\in \dF_q$. This is just 
\[
  \frac{\#\{F\in \sF_d:F(a)=0\}}{\#\sF_d} = \frac{1}{q+1} 
\]
where $\sF_d$ is the set of square-free monic polynomials of degree $d$. Note 
that $\frac{1}{q+1} = \frac{1-q}{q^2-1}$. We have that 
\[
  \# C(\dF_q) = \sum_{a\in \dP^1(\dF_q)} (1+\chi_2(F(a))) = q+1+\sum_{a\in \dP^1(\dF_q)} \chi_2(F(a)) .
\]
To get the distribution, we average over this family. 

\begin{theorem}
\[
  \frac{\#\{F\in\sF_d:F(a_i)=\alpha_i\text{ for }1\leq i\leq q\}}{\# \sF_d} \sim \left(\frac{1}{q+1}\right)^m \left(\frac{q}{(q+1)(q-1)}\right)^{q-m} 
\]
where $m$ is the number of $\alpha_i$ which are zero. 
\end{theorem}

\textbf{\ldots stopped taking notes\ldots}




